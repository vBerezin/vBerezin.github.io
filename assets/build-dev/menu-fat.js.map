{"version":3,"sources":["webpack://[name]/./common/classes/class-menu-fat.js"],"names":["MenuFat","root","options","Error","toggleText","class","wrapper","makeWrapper","rootWidth","Math","ceil","offsetWidth","children","tagName","querySelector","nav","el","makeNav","active","helper","makeHelper","itemsStorage","storeItemsData","itemsWidth","getItemsWidth","dataStorage","cropped","visible","parentNode","appendChild","calculate","bindEvents","nodes","map","node","item","width","display","style","storage","forEach","classList","add","remove","deactivate","activate","push","resetItem","cropItem","renderNav","document","createElement","className","toggle","innerHTML","items","join","timer","windowResizeHandler","clearTimeout","setTimeout","windowClickHandler","close","toggleHandler","event","preventDefault","stopPropagation","open","addEventListener","window","refresh"],"mappings":"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","file":"menu-fat.js","sourcesContent":["/**\n * @description жирное меню\n * прячет не влезающие пункты меню в гамбурер\n * */\nclass MenuFat {\n  constructor(root, options) {\n    if (!root) {\n      return new Error(typeof root);\n    }\n    this.options = Object.assign({\n      toggleText: '<span></span><span></span><span></span><span></span>',\n      class: '',\n    }, options);\n    this.root = root;\n    this.wrapper = this.makeWrapper(root);\n    this.rootWidth = Math.ceil(root.offsetWidth);\n    this.children = root.tagName === 'UL' ? root.children : root.querySelector('ul').children;\n    this.nav = {\n      el: this.makeNav(),\n      active: false,\n    };\n    this.helper = this.makeHelper();\n    this.itemsStorage = this.storeItemsData(this.children);\n    this.itemsWidth = this.getItemsWidth(this.itemsStorage);\n    this.dataStorage = {\n      cropped: [],\n      visible: [],\n    };\n\n    this.root.parentNode.appendChild(this.wrapper);\n    this.wrapper.appendChild(this.root);\n    this.wrapper.appendChild(this.helper.el);\n    this.wrapper.appendChild(this.nav.el);\n    this.calculate();\n    this.bindEvents();\n  }\n\n  storeItemsData(nodes) {\n    return [...nodes].map((node) => {\n      const item = node;\n      let width = Math.ceil(node.offsetWidth);\n      // если элемент не видимый\n      if (width === 0) {\n        const { display } = node.style;\n        item.style.display = '';\n        width = Math.ceil(node.offsetWidth);\n        item.style.display = display;\n      }\n      return { node, width };\n    });\n  }\n\n  getItemsWidth(storage) {\n    let width = 0;\n    storage.forEach((item) => {\n      width += item.width;\n    });\n    return width;\n  }\n\n  activate() {\n    this.wrapper.classList.add('is-active');\n    this.helper.el.style.display = 'block';\n    this.rootWidth = Math.ceil(this.root.offsetWidth);\n  }\n\n  deactivate() {\n    this.wrapper.classList.remove('is-active');\n    this.helper.el.style.display = 'none';\n    this.nav.el.style.display = 'none';\n    this.rootWidth = Math.ceil(this.root.offsetWidth);\n  }\n\n  calculate() {\n    let { cropped, visible } = this.dataStorage;\n    this.deactivate();\n    if (this.itemsWidth > this.rootWidth) {\n      this.activate();\n      cropped = [];\n      visible = [];\n      this.itemsWidth = 0;\n      this.itemsStorage.forEach((item) => {\n        this.itemsWidth += item.width;\n        if (this.itemsWidth > this.rootWidth) {\n          cropped.push(item);\n        } else {\n          visible.push(item);\n        }\n      });\n    } else {\n      visible = cropped;\n      cropped = [];\n    }\n    visible.forEach(item => this.resetItem(item.node));\n    cropped.forEach(item => this.cropItem(item.node));\n    this.dataStorage.cropped = cropped;\n    this.dataStorage.visible = visible;\n    this.renderNav(cropped);\n    return { cropped, visible };\n  }\n\n  makeWrapper(root) {\n    const wrapper = document.createElement('nav');\n    wrapper.className = `c-menu-fat ${this.options.class}`;\n    return wrapper;\n  }\n  makeHelper() {\n    const helper = document.createElement('div');\n    const toggle = document.createElement('button');\n    toggle.className = 'c-menu-fat__toggle';\n    toggle.innerHTML = this.options.toggleText;\n    helper.className = 'c-menu-fat__helper';\n    helper.appendChild(toggle);\n    return { el: helper, toggle };\n  }\n\n  makeNav() {\n    const nav = document.createElement('div');\n    nav.className = 'c-menu-fat__nav';\n    return nav;\n  }\n\n  renderNav(nodes) {\n    const items = nodes ? nodes.map(item => `<li>${item.node.innerHTML}</li>`).join('') : '';\n    this.nav.el.innerHTML = `<ul>${items}</ul>`;\n    return this.nav;\n  }\n\n  cropItem(node) {\n    const item = node;\n    item.style.display = 'none';\n    return item;\n  }\n\n  resetItem(node) {\n    const item = node;\n    item.style.display = '';\n    return item;\n  }\n\n  bindEvents() {\n    let timer;\n    const windowResizeHandler = () => {\n      clearTimeout(timer);\n      timer = setTimeout(() => {\n        this.calculate();\n      }, 500);\n    };\n    const windowClickHandler = () => {\n      this.close();\n    };\n    const toggleHandler = (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      if (this.nav.active) {\n        this.close();\n      } else {\n        this.open();\n      }\n    };\n\n    this.nav.el.addEventListener('click', event => event.stopPropagation());\n    this.nav.el.addEventListener('touchstart', event => event.stopPropagation());\n    this.helper.toggle.addEventListener('click', toggleHandler);\n    window.addEventListener('resize', windowResizeHandler);\n    window.addEventListener('click', windowClickHandler);\n    window.addEventListener('load', () => {\n      this.refresh();\n      this.calculate();\n    });\n  }\n\n\n  /**\n   * @public { open }\n   * */\n  open() {\n    this.nav.el.style.display = 'block';\n    this.nav.active = true;\n    this.helper.toggle.classList.add('is-active');\n  }\n\n  /**\n   * @public { close }\n   * */\n  close() {\n    this.nav.el.style.display = 'none';\n    this.nav.active = false;\n    this.helper.toggle.classList.remove('is-active');\n  }\n\n  /**\n   * @public { refresh } обновляет данные о ширине пунктов меню\n   * */\n  refresh() {\n    this.itemsStorage = this.storeItemsData(this.children);\n    this.itemsWidth = this.getItemsWidth(this.itemsStorage);\n    return this;\n  }\n}\nexport default MenuFat;\n"],"sourceRoot":""}